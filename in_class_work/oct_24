
/*dates*/

SELECT
date,
current_date,
age(current_date,date),
case when age(current_date,date) > '3 years' then true else false end,
date_trunc('month',date),
to_char(date, 'yyyy-mm'),
extract('quarter' from date)
FROM sales
WHERE
date > '2015-01-01'
Limit 100

SALES BY MONTH

SELECT
to_char(date, 'yyyy-mm'),
sum(total)
FROM sales
WHERE
date > '2014-01-01'
group by to_char(date, 'yyyy-mm')
order by to_char(date, 'yyyy-mm') desc
Limit 100
